<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8" />
    <title>SKF Track and Trace | Login</title>
    <link rel="icon" href="http://skf.com/favicon.ico">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
    <meta content="" name="description" />
    <meta content="" name="author" />

    <!-- ================== BEGIN BASE CSS STYLE ================== -->
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
    <link href="./dist/assets/plugins/jquery-ui/themes/base/minified/jquery-ui.min.css" rel="stylesheet" />
    <link href="./dist/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="./dist/assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
    <link href="./dist/assets/css/animate.min.css" rel="stylesheet" />
    <link href="./dist/assets/css/style.min.css" rel="stylesheet" />
    <link href="./dist/assets/css/style-responsive.min.css" rel="stylesheet" />
    <link href="./dist/assets/css/theme/default.css" rel="stylesheet" id="theme" />
    <!-- ================== END BASE CSS STYLE ================== -->

    <!-- ================== BEGIN BASE JS ================== -->
    <script src="./dist/assets/plugins/pace/pace.min.js">
    </script>
    <!-- ================== END BASE JS ================== -->
</head>

<body class="pace-top bg-white">
    <!-- begin #page-loader -->
    <div id="page-loader" class="fade in"><span class="spinner"></span></div>
    <!-- end #page-loader -->

    <!-- begin #page-container -->
    <div id="page-container" class="fade">
        <!-- begin login -->
        <div class="login login-with-news-feed">
            <!-- begin news-feed -->
            <div class="news-feed">
                <div class="news-image">
                    <img src="./dist/assets/img/login-bg/SKF-Ground-Transportation.jpg" data-id="login-cover-image" alt="" />
                    <!--<img src="http://www.ethcargo.com/wp-content/uploads/2015/04/Ground-Transportation.jpg" data-id="login-cover-image" alt="" />-->
                </div>
                <div class="news-caption" style="top: 0;">
                    <h4 class="caption-title" style="text-align: center;"><i class="fa fa-truck text-primary"></i> SKF Integrated Track and Trace Solution</h4>
                    <p style="text-align: center">
                        Get the latest tracking information related to your SKF shipments
                    </p>
                </div>
            </div>
            <!-- end news-feed -->
            <!-- begin right-content -->
            <div class="right-content">
                <!-- begin login-header -->
                <div class="login-header">
                    <div class="brand" style="text-align: center">
                        Track and Trace Login
                    </div>
                </div>
                <!-- end login-header -->
                <!-- begin login-content -->
                <div class="login-content">
                    <!-- <form id="loginForm" class="clearfix" action="/auth/cognito" method="post" class="margin-bottom-0"> -->
                    <form action="" method="post">
                        <div class="form-group m-b-15">
                            <input id="username" type="text" name="username" class="form-control input-lg" placeholder="User Name" required />
                        </div>
                        <div class="form-group m-b-15">
                            <input id="password" type="password" name="password" class="form-control input-lg" placeholder="Password" required />
                        </div>
                        <div class="checkbox m-b-30">
                            <label>
                                <input id="l-rememberPassword" name="rememberPassword" type="checkbox" /> Remember Me
                            </label>
                            <span style="float: right;"><a href="/forgotPassword">Forgot Password</a></span>
                        </div>
                        <div class="form-group m-b-15 loginErrorDiv hide">
                            <span style="color: red" class="loginErrorDivSpan">Incorrect User Name and / or password. Please try again!</span>
                        </div>
                        <div class="login-buttons">
                            <!-- <button type="submit" onclick="myFunction()" name="login_ok" class="btn btn-primary btn-block btn-lg">Sign me in</button> -->
                            <input type="submit" class="btn btn-primary btn-block btn-lg" id="submit-button" name="submit" value="Login" />
                        </div>
<!--                         <div class="m-t-20 m-b-40 p-b-40 text-inverse">
                            Not a member yet? Click <a href="/register" class="text-success">here</a> to register.
                        </div> -->
                        <hr/>
                    </form>
                </div>
                <!-- end login-content -->
            </div>
            <!-- end right-container -->
        </div>
        <!-- end login -->

    </div>
    <!-- end page container -->

    <!-- ================== BEGIN BASE JS ================== -->
    <script src="./dist/assets/plugins/jquery/jquery-1.9.1.min.js">
    </script>
    <script src="./dist/assets/plugins/jquery/jquery-migrate-1.1.0.min.js">
    </script>
    <script src="./dist/assets/plugins/jquery-ui/ui/minified/jquery-ui.min.js">
    </script>
    <script src="./dist/assets/plugins/bootstrap/js/bootstrap.min.js">
    </script>
    <!--[if lt IE 9]>
        <script src="assets/crossbrowserjs/html5shiv.js"></script>
        <script src="assets/crossbrowserjs/respond.min.js"></script>
        <script src="assets/crossbrowserjs/excanvas.min.js"></script>
    <![endif]-->
    <script src="./dist/assets/plugins/slimscroll/jquery.slimscroll.min.js">
    </script>
    <script src="./dist/assets/plugins/jquery-cookie/jquery.cookie.js">
    </script>
    <!-- ================== END BASE JS ================== -->

    <!-- ================== BEGIN PAGE LEVEL JS ================== -->
    <script src="./dist/assets/js/apps.min.js">
    </script>
    <!-- ================== END PAGE LEVEL JS ================== -->

    <script>
        $(document).ready(function() {
            App.init();
            handlePageContentView();
        });

        $("#submit-button").on("click", function(e) {
            // For demo purpose
            e.preventDefault();
            // alert("True");
            // document.getElementById("submit-button").disabled = true;
            var username = $('#username').val();
            var password = $('#password').val();
            var encodePass = btoa(password).toString();
            if((username == "")&&(password == "")){
                $(".loginErrorDivSpan").html('Fill User Name and Password');
                $(".loginErrorDiv").removeClass('hide');    
            }else if((username != "")&&(password == "")){
                $(".loginErrorDivSpan").html('Password is required');
                $(".loginErrorDiv").removeClass('hide');
            }else if((username == "")&&(password != "")){
                $(".loginErrorDivSpan").html('User Name is required');
                $(".loginErrorDiv").removeClass('hide');
            }else{
                $(".loginErrorDiv").addClass('hide');
            }
            if ((username != "") && (password != "")) {
                var obj = {
                    "username": username,
                    "password": encodePass,
                }
                // console.log("obj : ",obj);
                $.ajax({
                    type: 'POST',
                    url: '/auth/local',
                    data: {
                        identifier: username,
                        password: password
                    },
                    success: function(res) {
                        console.log("res : ", res);
                        if ((res.jwt != "") || (res.jwt != undefined)) {
                            var user = {
                                "email": res.user.email,
                                "role": res.user.role.name,
                                "username": res.user.username,
                                "role_id": res.user.role.id,
                                "token": res.jwt,
                            }
                            // console.log("user : ", user);
                            localStorage.setItem('user', JSON.stringify(user));
                            location.replace("./dist/dashboard.html");
                        }

                    },
                    error: function(err) {
                        // console.log("err : ",err);
                        $(".loginErrorDivSpan").html(err.responseJSON.message);
                        $(".loginErrorDiv").removeClass('hide');

                    }
                });
            }


        });
    </script>
</body>

</html>